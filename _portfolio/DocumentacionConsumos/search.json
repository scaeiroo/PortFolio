[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "LacorDual Sandra Caeiro",
    "section": "",
    "text": "Introducci√≥n al Proyecto",
    "crumbs": [
      "Introducci√≥n",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Informes Consumos</span>"
    ]
  },
  {
    "objectID": "index.html#comprensi√≥n-del-sistema-de-monitoreo-de-placas-solares",
    "href": "index.html#comprensi√≥n-del-sistema-de-monitoreo-de-placas-solares",
    "title": "LacorDual Sandra Caeiro",
    "section": "Comprensi√≥n del Sistema de Monitoreo de Placas Solares",
    "text": "Comprensi√≥n del Sistema de Monitoreo de Placas Solares\nPara iniciar este proyecto, fue esencial entender c√≥mo funciona el sistema de monitoreo de placas solares implementado en Lacor. El sistema actual permite el acceso a datos de consumo energ√©tico a trav√©s de una aplicaci√≥n web, pero presenta limitaciones en la extracci√≥n autom√°tica de informes y su posterior an√°lisis. La observaci√≥n detallada de los datos disponibles, su formato y el m√©todo manual de extracci√≥n fueron clave para dise√±ar una soluci√≥n eficiente que automatice este proceso.",
    "crumbs": [
      "Introducci√≥n",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Informes Consumos</span>"
    ]
  },
  {
    "objectID": "index.html#problem√°tica-identificada",
    "href": "index.html#problem√°tica-identificada",
    "title": "LacorDual Sandra Caeiro",
    "section": "Problem√°tica Identificada",
    "text": "Problem√°tica Identificada\nLa primera fase consisti√≥ en crear una m√°quina virtual con Ubuntu 24.04.1. En ella, instal√© El principal desaf√≠o identificado fue la imposibilidad de extraer de manera automatizada todos los datos necesarios utilizando las librer√≠as est√°ndar de Python. Las API disponibles no proporcionaban la totalidad de la informaci√≥n que s√≠ est√° accesible mediante la descarga manual desde la interfaz web. Esta limitaci√≥n obligaba a un proceso manual y tedioso para la obtenci√≥n de los informes diarios, mensuales y anuales, dificultando el an√°lisis continuo del rendimiento de las placas solares.\n\n\n\n\n\n\nLos intentos iniciales con diversas librer√≠as de Python revelaron que los datos obtenidos no coincid√≠an en cantidad ni calidad con los descargables manualmente desde la plataforma, lo que hizo necesario replantear la estrategia de extracci√≥n.",
    "crumbs": [
      "Introducci√≥n",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Informes Consumos</span>"
    ]
  },
  {
    "objectID": "index.html#objetivos-del-proyecto",
    "href": "index.html#objetivos-del-proyecto",
    "title": "LacorDual Sandra Caeiro",
    "section": "Objetivos del Proyecto",
    "text": "Objetivos del Proyecto\nEl proyecto se estructura en torno a dos objetivos principales:\n1- Desarrollo de una aplicaci√≥n de escritorio que permita:\n  - Extracci√≥n automatizada de informes diarios, mensuales y anuales\n  - Visualizaci√≥n gr√°fica de los datos obtenidos\n  - Interfaz intuitiva para la interacci√≥n con los datos\n2- Implementaci√≥n de un script de automatizaci√≥n que:\n  - Ejecute diariamente la extracci√≥n de datos\n  - Almacene la informaci√≥n en una base de datos MySQL\n  - Garantice la continuidad del registro hist√≥rico",
    "crumbs": [
      "Introducci√≥n",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Informes Consumos</span>"
    ]
  },
  {
    "objectID": "index.html#configuraci√≥n-del-entorno-de-desarrollo",
    "href": "index.html#configuraci√≥n-del-entorno-de-desarrollo",
    "title": "LacorDual Sandra Caeiro",
    "section": "Configuraci√≥n del Entorno de Desarrollo",
    "text": "Configuraci√≥n del Entorno de Desarrollo\nPara abordar este proyecto, se configur√≥ un entorno de desarrollo con las siguientes herramientas:\n\nPython 3.10: Lenguaje principal para el desarrollo del scraping y la aplicaci√≥n\nSelenium: Framework para automatizar la navegaci√≥n web y extracci√≥n de datos\nMySQL: Sistema de gesti√≥n de base de datos para el almacenamiento permanente\nPyQt5/Tkinter: Bibliotecas para el desarrollo de la interfaz gr√°fica\nMatplotlib/Seaborn: Herramientas para la visualizaci√≥n gr√°fica de datos\nGitHub: Sistema de control de versiones para el seguimiento del desarrollo\n\n\n  \n\nEste conjunto de herramientas proporciona la base tecnol√≥gica necesaria para desarrollar una soluci√≥n robusta que cumpla con los requisitos establecidos. La elecci√≥n de Selenium como herramienta de web scraping responde directamente a la necesidad de emular la navegaci√≥n humana para acceder a todos los datos disponibles en la plataforma.",
    "crumbs": [
      "Introducci√≥n",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Informes Consumos</span>"
    ]
  },
  {
    "objectID": "index.html#metodolog√≠a-de-trabajo",
    "href": "index.html#metodolog√≠a-de-trabajo",
    "title": "LacorDual Sandra Caeiro",
    "section": "Metodolog√≠a de Trabajo",
    "text": "Metodolog√≠a de Trabajo\nEl desarrollo del proyecto sigue una metodolog√≠a iterativa:\n1- An√°lisis preliminar: Estudio de la estructura de la web y los datos disponibles\n2- Desarrollo del scraper: Implementaci√≥n del sistema de extracci√≥n automatizada\n3- Construcci√≥n de la aplicaci√≥n: Desarrollo de la interfaz y funcionalidades de usuario\n4- Automatizaci√≥n: Creaci√≥n del script para la ejecuci√≥n programada\n5- Pruebas y optimizaci√≥n: Verificaci√≥n de la fiabilidad y rendimiento del sistema\nEsta aproximaci√≥n garantiza la adaptabilidad del sistema ante posibles cambios en la plataforma de origen, manteniendo la integridad de los datos y la continuidad del servicio.",
    "crumbs": [
      "Introducci√≥n",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Informes Consumos</span>"
    ]
  },
  {
    "objectID": "app.html",
    "href": "app.html",
    "title": "App",
    "section": "",
    "text": "Desarrollo de la Aplicaci√≥n de Escritorio",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>App</span>"
    ]
  },
  {
    "objectID": "app.html#arquitectura-del-sistema",
    "href": "app.html#arquitectura-del-sistema",
    "title": "App",
    "section": "Arquitectura del Sistema",
    "text": "Arquitectura del Sistema\nPara iniciar este proyecto, fue esencial entender c√≥mo funciona el sistema de monitoreo de placas solares implementado en Lacor. El sistema actual permite el acceso a datos de consumo energ√©tico a trav√©s de una aplicaci√≥n web, pero presenta limitaciones en la extracci√≥n autom√°tica de informes y su posterior an√°lisis. La observaci√≥n detallada de los datos disponibles, su formato y el m√©todo manual de extracci√≥n fueron clave para dise√±ar una soluci√≥n eficiente que automatice este proceso.\nLa aplicaci√≥n se estructura en tres componentes principales que interact√∫an para garantizar un flujo de trabajo eficiente:\n\n1. Gesti√≥n de Configuraci√≥n\nClases clave: ConfigManager, SetupDialog\n\nAlmacena rutas de directorios para informes y descargas\nPersiste configuraciones entre sesiones mediante archivo TXT\nValida estructura de carpetas (InformesMensuales, InformesAnuales, InformesDiarios)\n\n\n\n2. N√∫cleo de Automatizaci√≥n\nClases clave: GoodWeApp (m√©todos de scraping)\n\nImplementa navegaci√≥n web automatizada con Selenium\nManeja autenticaci√≥n, selecci√≥n de plantas solares y par√°metros temporales\nEjecuta descargas en segundo plano con gesti√≥n de threads\n\n\n\n3. Interfaz Gr√°fica\nComponentes: ttk.Notebook, FigureCanvasTkAgg, ScrolledText\n\nSistema de pesta√±as para diferentes funcionalidades\nVisualizaci√≥n interactiva de gr√°ficos con Matplotlib\nPanel de registro de actividades con colores sem√°nticos\n\n# Ejemplo de estructura principal\nclass GoodWeApp:\n    def __init__(self, root):\n        self.config_manager = ConfigManager()\n        self._create_notebook()\n        self._crear_interfaz_generar_informe()\n        self._crear_interfaz_graficar_informe()",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>App</span>"
    ]
  },
  {
    "objectID": "app.html#funcionalidades-clave",
    "href": "app.html#funcionalidades-clave",
    "title": "App",
    "section": "Funcionalidades Clave",
    "text": "Funcionalidades Clave\n\n1. Generaci√≥n Automatizada de Informes\nTipos soportados:\n    - Diarios: Descarga paralela de dos plantas solares\n\n    - Mensuales: Consolidaci√≥n en archivo √∫nico\n\n    - Anuales: Agregaci√≥n de datos mensuales\n\n\n\n\n\n\nProceso optimizado:\ndef proceso_descarga_informes(self):\n    chrome_options = Options()\n    chrome_options.add_argument(\"--headless=new\")  # Ejecuci√≥n sin UI\n    driver = webdriver.Chrome(service=Service(...), options=chrome_options)\n    # Flujo completo de navegaci√≥n automatizada\n\n\n2. Sistema Inteligente de Gesti√≥n de Archivos\n\nRenombrado autom√°tico seg√∫n convenci√≥n:\n\nDD_MM_YYYY_Planta[1|2].xls para diarios\nMM_YYYY_Planta_1_2.xls para mensuales\n\nLimpieza de duplicados en destino\nValidaci√≥n de integridad de archivos\n\n\n\n3. Visualizaci√≥n Interactiva\n\nDetecci√≥n autom√°tica del tipo de informe\nGr√°ficos temporales con resoluci√≥n diaria/mensual\nPersonalizaci√≥n de ejes y leyendas\n\ndef graficar_datos_mensuales(self, df, grafica_frame, archivo):\n    fig, ax = plt.subplots(figsize=(10, 5))\n    ax.plot(df['D√≠a'], df['Consumo(kWh)'], marker='o')\n    canvas = FigureCanvasTkAgg(fig, master=grafica_frame)",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>App</span>"
    ]
  },
  {
    "objectID": "app.html#flujo-de-trabajo-del-usuario",
    "href": "app.html#flujo-de-trabajo-del-usuario",
    "title": "App",
    "section": "Flujo de Trabajo del Usuario",
    "text": "Flujo de Trabajo del Usuario\n1- Configuraci√≥n Inicial\n\nDi√°logo guiado para selecci√≥n de directorios\nValidaci√≥n de rutas t√≠picas de descargas\n\n\n\n\n\n\n\n2- Generaci√≥n de Informes\n\nSelecci√≥n de par√°metros mediante controles intuitivos\nBarra de progreso indeterminada durante operaciones\n\n\n\n\n\n\n\n3- Visualizaci√≥n de Datos\n\nSelector de archivos integrado\nRegeneraci√≥n din√°mica de gr√°ficos",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>App</span>"
    ]
  },
  {
    "objectID": "app.html#manejo-de-errores-avanzado",
    "href": "app.html#manejo-de-errores-avanzado",
    "title": "App",
    "section": "Manejo de Errores Avanzado",
    "text": "Manejo de Errores Avanzado\nSistema de logging multi-nivel:\n    - Registro en interfaz y archivo simult√°neo\n\n    - Codificaci√≥n por colores y emojis\n\n    - Salida formateada para diagn√≥stico\ndef log(self, mensaje, tipo=\"info\"):\n    emoji_map = {\"success\": \"‚úÖ\", \"error\": \"‚ùå\", \"path\": \"üìÇ\"}\n    self.log_text.insert(tk.END, f\"[{timestamp}] {emoji} {mensaje}\\n\")\nMecanismos de recuperaci√≥n:\n  - Reintentos autom√°ticos en fallos de conexi√≥n\n\n  - Validaci√≥n de formatos de fecha\n\n  - Manejo de timeouts en elementos din√°micos\n  \nProcesamiento de Datos\n  - Detecci√≥n autom√°tica de encabezados en Excel\n\n  - Normalizaci√≥n de nombres de plantas\n\n  - Manejo de valores faltantes y outliers",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>App</span>"
    ]
  },
  {
    "objectID": "app.html#diagrama-de-flujo-principal",
    "href": "app.html#diagrama-de-flujo-principal",
    "title": "App",
    "section": "Diagrama de Flujo Principal",
    "text": "Diagrama de Flujo Principal\n\n\n\n\n\ngraph TD\n  A[Inicio] --&gt; B{Configuraci√≥n v√°lida?}\n  B --&gt;|No| C[Mostrar di√°logo de configuraci√≥n]\n  B --&gt;|S√≠| D[Mostrar interfaz principal]\n  D --&gt; E[Seleccionar tipo de informe]\n  E --&gt; F[Introducir par√°metros temporales]\n  F --&gt; G[Ejecutar scraping en background]\n  G --&gt; H{Mover y renombrar archivo?}\n  H --&gt;|√âxito| I[Mostrar gr√°fico]\n  H --&gt;|Error| J[Registrar en log y notificar]\n\n\n\n\n\n\n\n\n\n\n\n\nLa aplicaci√≥n logra reducir el tiempo de generaci√≥n de informes de 15 minutos (manual) a 2 minutos promedio, con una tasa de √©xito del 98% en condiciones normales de red.",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>App</span>"
    ]
  },
  {
    "objectID": "automatizacion.html",
    "href": "automatizacion.html",
    "title": "Automatizaci√≥n de Informes",
    "section": "",
    "text": "Sistema de Automatizaci√≥n",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Automatizaci√≥n de Informes</span>"
    ]
  },
  {
    "objectID": "automatizacion.html#arquitectura-del-proceso",
    "href": "automatizacion.html#arquitectura-del-proceso",
    "title": "Automatizaci√≥n de Informes",
    "section": "Arquitectura del Proceso",
    "text": "Arquitectura del Proceso\nEl sistema est√° dise√±ado para ejecutarse aut√≥nomamente en un servidor Linux, realizando descargas diarias de datos de producci√≥n y consumo de plantas solares durante la madrugada. La soluci√≥n combina t√©cnicas de web scraping, procesamiento de datos ETL y gesti√≥n de bases de datos, operando completamente en segundo plano sin intervenci√≥n humana.\n\nComponentes Principales\n\n\n\n\n\ngraph LR\n  A[Servidor Linux] --&gt; B[Crontab]\n  B --&gt; C[Script Shell]\n  C --&gt; D[Scraping con Selenium]\n  D --&gt; E[Procesamiento XLS]\n  E --&gt; F[MySQL]\n  F --&gt; G[Limpieza de Archivos]",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Automatizaci√≥n de Informes</span>"
    ]
  },
  {
    "objectID": "automatizacion.html#funcionalidades-clave",
    "href": "automatizacion.html#funcionalidades-clave",
    "title": "Automatizaci√≥n de Informes",
    "section": "Funcionalidades Clave",
    "text": "Funcionalidades Clave\n\n1. Ejecuci√≥n Programada\nProgramaci√≥n mediante Crontab Se ejecuta diariamente a las 23:30 horas para capturar datos consolidados:\n# Configuraci√≥n en crontab -e\n0 22 * * * /bin/bash /ruta/EjecuccionDiaria_Informes.sh\nModo Headless Chrome se ejecuta sin interfaz gr√°fica para optimizar recursos:\nchrome_options.add_argument(\"--headless=new\")\nchrome_options.add_argument(\"--disable-gpu\")\n\n\n2. Flujo de Datos\n\nDescarga paralela de 2 plantas solares\nRenombrado inteligente de archivos\nValidaci√≥n de estructura de datos\nCarga en base de datos MySQL\nEliminaci√≥n segura de temporales\n\n\n\n2. Flujo de Datos\nEstructura de Directorios\n‚îú‚îÄ‚îÄ InformesDiarios/\n‚îÇ   ‚îú‚îÄ‚îÄ 15_06_2024_Planta1.xls\n‚îÇ   ‚îî‚îÄ‚îÄ 15_06_2024_Planta2.xls\n‚îî‚îÄ‚îÄ Logs/\n    ‚îî‚îÄ‚îÄ Log_2024-06-15T23:30:01.log\nRenombrado automat√°tico\nbase_name = f\"{day:02d}_{month:02d}_{year}_Planta\"",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Automatizaci√≥n de Informes</span>"
    ]
  },
  {
    "objectID": "automatizacion.html#mecanismos-de-robustez",
    "href": "automatizacion.html#mecanismos-de-robustez",
    "title": "Automatizaci√≥n de Informes",
    "section": "Mecanismos de Robustez",
    "text": "Mecanismos de Robustez\n\n1. Manejo de Errores\n\nReintentos autom√°ticos en fallos de conexi√≥n\nValidaci√≥n de columnas esenciales en Excel\nRegistro detallado con c√≥digos de color:\n\ndef log_color(mensaje, color, nivel=logging.INFO):\n    logging.log(nivel, f\"{color}{mensaje}{COLOR_RESET}\")\n\n\n2. Seguridad de Datos\n\nTransacciones ACID en MySQL\nManejo de valores nulos:\n\nrow['capacidad_kw'] if pd.notna(row['capacidad_kw']) else None\n\nEliminaci√≥n verificada de archivos procesados",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Automatizaci√≥n de Informes</span>"
    ]
  },
  {
    "objectID": "automatizacion.html#proceso-de-carga-en-mysql",
    "href": "automatizacion.html#proceso-de-carga-en-mysql",
    "title": "Automatizaci√≥n de Informes",
    "section": "Proceso de Carga en MySQL",
    "text": "Proceso de Carga en MySQL\n\nDetalle del Flujo de Datos\n\n\n\n\n\ngraph TB\n    A[Archivo XLS Descargado] --&gt; B{Procesamiento}\n    B --&gt; C[Extracci√≥n de Columnas Clave]\n    C --&gt; D[Validaci√≥n de Datos]\n    D --&gt; E[Conversi√≥n de Tipos]\n    E --&gt; F[Limpieza de Valores Nulos]\n    F --&gt; G[Generaci√≥n de Query SQL]\n    G --&gt; H[Inserci√≥n en MySQL]\n    H --&gt; I[Commit Transacci√≥n]\n    I --&gt; J[Eliminaci√≥n Segura del Archivo]\n\n\n\n\n\n\n\n\nExplicaci√≥n de la Consulta SQL\nINSERT INTO InformesDiariosGoodWe (\n    fecha,         # Fecha del informe (YYYY-MM-DD)\n    hora,          # Hora de registro (HH:MM)\n    planta,        # N√∫mero de planta (1/2)\n    clasificacion, # Tipo de registro (Ej: \"Generaci√≥n\")\n    capacidad_kw,  # Capacidad instalada (kW)\n    generacion_kwh,# Energ√≠a generada (kWh)\n    salida_kwh,    # Energ√≠a entregada a red (kWh)\n    vender_kwh,    # Energ√≠a vendida (kWh)\n    comprar_kwh,   # Energ√≠a comprada (kWh)\n    consumo_kwh,   # Consumo total (kWh)\n    autoconsumo_fv_kwh, # Autoconsumo fotovoltaico (kWh)\n    proporcion_personal, # % de uso personal\n    contribution_ratio,  # Ratio de contribuci√≥n\n    ingresos             # Ingresos monetarios ()\n) \nVALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)\n\nMapeo de Datos\n\n\n\n\n\n\n\n\n\nCampo MySQL\nOrigen Excel\nTipo Dato\nRestricciones\n\n\n\n\nfecha\nNombre del archivo (DD_MM_YYYY)\nDATE\nNOT NULL\n\n\nhora\nPrimera columna del XLS\nVARCHAR\n-\n\n\nplanta\nSufijo _PlantaX en nombre archivo\nINT\nCHECK (1 ‚â§ planta ‚â§ 2)\n\n\nclasificacion\nColumna \"Clasificaci√≥n\"\nVARCHAR\n-\n\n\ncapacidad_kw\nColumna \"Capacidad(kW)\"\nFLOAT\nDEFAULT 0\n\n\n\n\n\n\nMecanismos de Seguridad\n1- Validaci√≥n de Tipos: Conversi√≥n expl√≠cita a tipos MySQL\ndf['capacidad_kw'] = pd.to_numeric(df['Capacidad(kW)'], errors='coerce')\n2- Manejo de Nulos:\nrow['generacion_kwh'] if pd.notna(row['generacion_kwh']) else None\n3- Transacciones ACID:\ntry:\n    cursor.execute(query, values)\n    con.commit()  # Confirmaci√≥n expl√≠cita\nexcept:\n    con.rollback()",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Automatizaci√≥n de Informes</span>"
    ]
  },
  {
    "objectID": "automatizacion.html#flujo-completo",
    "href": "automatizacion.html#flujo-completo",
    "title": "Automatizaci√≥n de Informes",
    "section": "Flujo Completo",
    "text": "Flujo Completo\n\n\n\n\n\nsequenceDiagram\n    participant Script\n    participant Excel\n    participant MySQL\n    \n    Script-&gt;&gt;Excel: Leer archivo XLS\n    Excel-&gt;&gt;Script: DataFrame con 14 columnas\n    Script-&gt;&gt;Script: Normalizar nombres de campos\n    Script-&gt;&gt;Script: Eliminar filas corruptas\n    Script-&gt;&gt;MySQL: Establecer conexi√≥n\n    loop Para cada fila\n        Script-&gt;&gt;MySQL: Ejecutar INSERT\n    end\n    MySQL-&gt;&gt;Script: Confirmar transacci√≥n\n    Script-&gt;&gt;Excel: Eliminar archivo procesado",
    "crumbs": [
      "Desarrollo",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Automatizaci√≥n de Informes</span>"
    ]
  }
]